<!DOCTYPE html>
<html>
<head>
    <meta charset="GB2312">
    <title>热力图</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.4 -->
    <link href="assets/global/plugins/bootstrap_LTE/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <!--    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />-->
    <!-- Font Awesome Icons -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <!-- Ionicons -->
    <link href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" type="text/css" />
    <!-- Theme style -->
    <link href="assets/global/plugins/bootstrap_LTE/dist/css/AdminLTE.min.css" rel="stylesheet" />
    <!--    <link href="assets/global/plugins/bootstrap_LTE/dist/css/AdminLTE.css" rel="stylesheet" />-->
    <!--    <link href="dist/css/AdminLTE.min.css" rel="stylesheet" type="text/css" />-->
    <!-- AdminLTE Skins. We have chosen the skin-blue for this starter
          page. However, you can choose any other skin. Make sure you
          apply the skin class to the body tag so the changes take effect.
    -->
    <link href="assets/global/plugins/dialog/css/dialog.css" rel="stylesheet" type="text/css" />
    <link href="assets/global/plugins/bootstrap_LTE/dist/css/skins/skin-blue-light.min.css" rel="stylesheet" />
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        .echart
        {
            height: 400px;
        }

        .main-header .sidebar-toggle
        {
            padding: 7px 15px;
        }

        .main-header
        {
            height: 36px;
            overflow: hidden;
        }

            .main-header .logo
            {
                line-height: 36px;
                height: 36px;
            }

            .main-header > .navbar
            {
                min-height: 36px;
            }

            .main-header .navbar .nav > li > a > .label
            {
                top: 6px;
            }

        .skin-blue-light .main-header .navbar .nav > li > a
        {
            padding: 7px 15px;
        }
    </style>
</head>
<!--
  BODY TAG OPTIONS:
  =================
  Apply one or more of the following classes to get the
  desired effect
  |---------------------------------------------------------|
  | SKINS         | skin-blue                               |
  |               | skin-black                              |
  |               | skin-purple                             |
  |               | skin-yellow                             |
  |               | skin-red                                |
  |               | skin-green                              |
  |---------------------------------------------------------|
  |LAYOUT OPTIONS | fixed                                   |
  |               | layout-boxed                            |
  |               | layout-top-nav                          |
  |               | sidebar-collapse                        |
  |               | sidebar-mini                            |
  |---------------------------------------------------------|
  -->
<body class="skin-blue-light sidebar-mini">

    <div class="wrapper">
        <!-- Main Header -->
        <header class="main-header">
            <!-- Logo -->
            <a href="index2.html" class="logo">
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg"><b>Data-Products</b></span>
            </a>
            <!-- Header Navbar -->
            <nav class="navbar navbar-static-top" role="navigation">
                <!-- Sidebar toggle button-->
                <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                    <span class="sr-only">切换导航</span>
                </a>
                <div class="navbar-right">
                    <ul class="nav navbar-nav">
                        <!-- Messages: style can be found in dropdown.less-->
                        <li class="dropdown messages-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-envelope"></i>
                                <span class="label label-success">4</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="header">You have 4 messages</li>
                                <li>
                                    <!-- inner menu: contains the actual data -->
                                    <ul class="menu">
                                        <li><!-- start message -->
                                            <a href="#">
                                                <div class="pull-left">
                                                    <img src="../img/avatar3.png" class="img-circle" alt="User Image">
                                                </div>
                                                <h4>
                                                    Support Team
                                                    <small><i class="fa fa-clock-o"></i> 5 mins</small>
                                                </h4>
                                                <p>Why not buy a new awesome theme?</p>
                                            </a>
                                        </li><!-- end message -->
                                        <li>
                                            <a href="#">
                                                <div class="pull-left">
                                                    <img src="../img/avatar2.png" class="img-circle" alt="user image">
                                                </div>
                                                <h4>
                                                    AdminLTE Design Team
                                                    <small><i class="fa fa-clock-o"></i> 2 hours</small>
                                                </h4>
                                                <p>Why not buy a new awesome theme?</p>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <div class="pull-left">
                                                    <img src="../img/avatar.png" class="img-circle" alt="user image">
                                                </div>
                                                <h4>
                                                    Developers
                                                    <small><i class="fa fa-clock-o"></i> Today</small>
                                                </h4>
                                                <p>Why not buy a new awesome theme?</p>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <div class="pull-left">
                                                    <img src="../img/avatar2.png" class="img-circle" alt="user image">
                                                </div>
                                                <h4>
                                                    Sales Department
                                                    <small><i class="fa fa-clock-o"></i> Yesterday</small>
                                                </h4>
                                                <p>Why not buy a new awesome theme?</p>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <div class="pull-left">
                                                    <img src="../img/avatar.png" class="img-circle" alt="user image">
                                                </div>
                                                <h4>
                                                    Reviewers
                                                    <small><i class="fa fa-clock-o"></i> 2 days</small>
                                                </h4>
                                                <p>Why not buy a new awesome theme?</p>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="footer"><a href="#">See All Messages</a></li>
                            </ul>
                        </li>
                        <!-- Notifications: style can be found in dropdown.less -->
                        <li class="dropdown notifications-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-warning"></i>
                                <span class="label label-warning">10</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="header">You have 10 notifications</li>
                                <li>
                                    <!-- inner menu: contains the actual data -->
                                    <ul class="menu">
                                        <li>
                                            <a href="#">
                                                <i class="ion ion-ios7-people info"></i> 5 new members joined today
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <i class="fa fa-warning danger"></i> Very long description here that may not fit into the page and may cause design problems
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <i class="fa fa-users warning"></i> 5 new members joined
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="ion ion-ios7-cart success"></i> 25 sales made
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <i class="ion ion-ios7-person danger"></i> You changed your username
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="footer"><a href="#">View all</a></li>
                            </ul>
                        </li>
                        <!-- Tasks: style can be found in dropdown.less -->
                        <li class="dropdown tasks-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-tasks"></i>
                                <span class="label label-danger">9</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="header">You have 9 tasks</li>
                                <li>
                                    <!-- inner menu: contains the actual data -->
                                    <ul class="menu">
                                        <li><!-- Task item -->
                                            <a href="#">
                                                <h3>
                                                    Design some buttons
                                                    <small class="pull-right">20%</small>
                                                </h3>
                                                <div class="progress xs">
                                                    <div class="progress-bar progress-bar-aqua" style="width: 20%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                        <span class="sr-only">20% Complete</span>
                                                    </div>
                                                </div>
                                            </a>
                                        </li><!-- end task item -->
                                        <li><!-- Task item -->
                                            <a href="#">
                                                <h3>
                                                    Create a nice theme
                                                    <small class="pull-right">40%</small>
                                                </h3>
                                                <div class="progress xs">
                                                    <div class="progress-bar progress-bar-green" style="width: 40%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                        <span class="sr-only">40% Complete</span>
                                                    </div>
                                                </div>
                                            </a>
                                        </li><!-- end task item -->
                                        <li><!-- Task item -->
                                            <a href="#">
                                                <h3>
                                                    Some task I need to do
                                                    <small class="pull-right">60%</small>
                                                </h3>
                                                <div class="progress xs">
                                                    <div class="progress-bar progress-bar-red" style="width: 60%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                        <span class="sr-only">60% Complete</span>
                                                    </div>
                                                </div>
                                            </a>
                                        </li><!-- end task item -->
                                        <li><!-- Task item -->
                                            <a href="#">
                                                <h3>
                                                    Make beautiful transitions
                                                    <small class="pull-right">80%</small>
                                                </h3>
                                                <div class="progress xs">
                                                    <div class="progress-bar progress-bar-yellow" style="width: 80%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                        <span class="sr-only">80% Complete</span>
                                                    </div>
                                                </div>
                                            </a>
                                        </li><!-- end task item -->
                                    </ul>
                                </li>
                                <li class="footer">
                                    <a href="#">View all tasks</a>
                                </li>
                            </ul>
                        </li>
                        <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="glyphicon glyphicon-user"></i>
                                <span>Jane Doe <i class="caret"></i></span>
                            </a>
                            <ul class="dropdown-menu">
                                <!-- User image -->
                                <li class="user-header bg-light-blue">
                                    <img src="../img/avatar3.png" class="img-circle" alt="User Image">
                                    <p>
                                        Jane Doe - Web Developer
                                        <small>Member since Nov. 2012</small>
                                    </p>
                                </li>
                                <!-- Menu Body -->
                                <li class="user-body">
                                    <div class="col-xs-4 text-center">
                                        <a href="#">Followers</a>
                                    </div>
                                    <div class="col-xs-4 text-center">
                                        <a href="#">Sales</a>
                                    </div>
                                    <div class="col-xs-4 text-center">
                                        <a href="#">Friends</a>
                                    </div>
                                </li>
                                <!-- Menu Footer-->
                                <li class="user-footer">
                                    <div class="pull-left">
                                        <a href="#" class="btn btn-default btn-flat">Profile</a>
                                    </div>
                                    <div class="pull-right">
                                        <a href="#" class="btn btn-default btn-flat">Sign out</a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>

        </header>

        <!-- Left side column. contains the logo and sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">
                <ul class="sidebar-menu">
                    <li class="active">
                        <a href="heatmap.html">
                            <i class="fa fa-eye"></i> <span>热力图</span>

                        </a>
                    </li>
                    <li><a href="document.html" target="_blank"><i class="fa fa-book"></i><span>在线文档</span></a></li>
                </ul>
            </section>
            <!-- /.sidebar -->
        </aside>
        <!-- Content Wrapper. Contains page content -->

        <div class="content-wrapper" style="min-height: 916px;">
            <!-- Content Header (Page header) -->
            <!-- Main content -->
            <section class="content">
                <!-- /.row -->
                <div class="row">
                    <div class="col-xs-12">
                        <div class="box box-primary">
                            <div class="box-header" data-toggle="tooltip" title="">
                                <h3 class="box-title">点击热度分析</h3>
                            </div>
                            <div class="box-body">
                                Box class: <code>.box.box-primary</code>
                                <p>
                                    amber, microbrewery abbey hydrometer, brewpub ale lauter tun saccharification oxidized barrel.
                                    berliner weisse wort chiller adjunct hydrometer alcohol aau!
                                    sour/acidic sour/acidic chocolate malt ipa ipa hydrometer.
                                </p>
                            </div><!-- /.box-body -->
                            <div class="box-footer">
                                <code>.box-footer</code>
                            </div><!-- /.box-footer-->
                        </div>
                        <!-- /.nav-tabs-custom -->
                    </div>
                </div>
            </section>
            <!-- /.content -->
        </div>

        <!-- /.content-wrapper -->
        <!-- Main Footer -->
        <!--<footer class="main-footer">-->
        <!-- To the right -->
        <!--<div class="pull-right hidden-xs">
                报表开发框架
            </div>-->
        <!-- Default to the left -->
        <!--<strong>Copyright &copy; 2015 <a href="http://www.autohome.com.cn">Company</a>.</strong> All rights reserved.

        </footer>-->
        <!-- /.control-sidebar -->
        <!-- Add the sidebar's background. This div must be placed
           immediately after the control sidebar -->
        <div class="control-sidebar-bg"></div>
    </div>
    <!-- ./wrapper -->

    <div id="container">

    </div>

    <!-- REQUIRED JS SCRIPTS -->

    <!-- jQuery 2.1.4 -->
    <script src="assets/global/plugins/jquery-1.11.0.min.js"></script>
    <script src="assets/global/plugins/gridster/js/jquery.gridster.js"></script>
    <!--    <script src="plugins/jQuery/jQuery-2.1.4.min.js" type="text/javascript"></script>-->
    <!-- Bootstrap 3.3.2 JS -->
    <!--<script src="bootstrap/js/bootstrap.min.js" type="text/javascript"></script>-->
    <script src="assets/global/plugins/bootstrap_LTE/bootstrap/js/bootstrap.min.js"></script>
    <!-- AdminLTE App -->
    <!--    <script src="dist/js/app.min.js" type="text/javascript"></script>-->
    <script src="assets/global/plugins/bootstrap_LTE/dist/js/app.js"></script>
    <!--  Optionally, you can add Slimscroll and FastClick plugins.
          Both of these plugins are recommended to enhance the
          user experience. Slimscroll is required when using the
          fixed layout. -->
    <style type="text/css">
    </style>




    <link href="assets/global/plugins/table/jquerytable.css" rel="stylesheet" />
    <link href="assets/global/plugins/select2/select2.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css" />
    <script src="assets/global/plugins/table/jquerytable.js"></script>
    <script src="assets/global/plugins/Chart/highcharts.js"></script>

    <script src="assets/global/scripts/metronic.js" type="text/javascript"></script>
    <script src="assets/global/plugins/select2/select2.min.js"></script>
    <script type="text/javascript" src="assets/global/plugins/bootstrap-daterangepicker/moment.min.js"></script>
    <script type="text/javascript" src="assets/global/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
    <script src="assets/local/script/sdlbase.js"></script>
    <script src="assets/local/script/sdltool.js"></script>
    <script src="assets/local/script/sdlpagebase.js"></script>
    <script src="assets/local/script/sdldatepicker.js"></script>
    <script type="text/javascript" src="assets/global/scripts/artTemplate.js"></script>
    <script src="assets/global/plugins/echart/echarts-all.js"></script>



    <!--页面控件模版 开始 -->
    <!--calendar -->
    <script id="page-calendar" type="text/html">
        <div class="form-group">
            <label class="col-md-2 control-label">选择日期：</label>
            <div class="col-md-2">
                <div class="btn btn-default" data-format="YYYY-MM-DD"  id="reportrange">
                    <i class="fa fa-calendar"></i>
                    &nbsp; <span></span>
                    <b class="fa fa-angle-down"></b>
                </div>
            </div>
        </div>
    </script>
      <script id="page-calendar-code" type="text/html">
        <div class="form-group">
            <label class="col-md-1 control-label">选择日期：</label>
            <div class="col-md-2">
                <div class="btn btn-default" data-format="YYYY-MM-DD"  id="reportrange">
                    <i class="fa fa-calendar"></i>
                    &nbsp; <span></span>
                    <b class="fa fa-angle-down"></b>
                </div>
            </div>
        </div>
    </script>
    <!--calendar -->
    <!--select -->
    <script id="page-select" type="text/html">
        <div class="form-group">
            <label class="col-md-2 control-label">{{text}}：</label>
            <div class="col-md-2">
                <select id="{{id}}"
                    data-type="{{source}}"
                    data-default="{{defval}}"
                    query-type="{{querytype}}"
                    data-target="select"
                    data-for="{{datafor}}"
                    data-ref="{{dataref}}"
                    {{if selecttype !="multiple"}}
                         class="js-example-basic-single">
                    {{else}}
                         class="js-example-basic-multiple" multiple="multiple">
                    {{/if}}
                    {{each localsoucrce as val}}<option value="{{val.key}}">{{val.text}}</option>
                    {{/each}}
                </select>
            </div>
        </div>
    </script>
    <script id="page-select-code" type="text/html">
        <div class="form-group">
            <label class="col-md-1 control-label">{{text}}：</label>
            <div class="col-md-2">
                <select id="{{id}}"
                    data-type="{{source}}"
                    data-default="{{defval}}"
                    query-type="{{querytype}}"
                    data-target="select"
                    data-for="{{datafor}}"
                    data-ref="{{dataref}}"
                    {{if selecttype !="multiple"}}
                         class="js-example-basic-single">
                    {{else}}
                         class="js-example-basic-multiple" multiple="multiple">
                    {{/if}}
                    {{each localsoucrce as val}}<option value="{{val.key}}">{{val.text}}</option>
                    {{/each}}
                </select>
            </div>
        </div>
    </script>
    <!--select -->
    <!-- tab -->
    <script id="page-tab" type="text/html">
        <div class="form-group">
                <label class="col-md-2 control-label">{{text}}：</label>
                    <div class="col-md-10 control-label">
                        <ul class="nav nav-pills" id="{{id}}" data-target="sampletab">
                                {{each source as value i}}
                                    <li {{ if i=="0"}}
                                        class="active"
                                        {{/if}}>
                                    <a data-value="{{value.key}}" href="#">{{value.text}}</a>
                                </li>
                                {{/each}}
                        </ul>
                    </div>
            </div>
    </script>
    <script id="page-tab-code" type="text/html">
        <div class="form-group">
                <label class="col-md-1 control-label">{{text}}：</label>
                    <div class="col-md-11 control-label">
                        <ul class="nav nav-pills" id="{{id}}" data-target="sampletab">
                                {{each source as value i}}
                                    <li {{ if i=="0"}}
                                        class="active"
                                        {{/if}}>
                                    <a data-value="{{value.key}}" href="#">{{value.text}}</a>
                                </li>
                                {{/each}}
                        </ul>
                    </div>
            </div>
    </script>
    <!-- tab -->
    <!-- spline -->
    <script id="page-chart" type="text/html">
        <div class="portlet box blue-madison">
        <div class="box box-primary">
            <div class="box-header with-border">
                <h3 class="box-title">{{chartitle}}</h3>
            </div>
            <div class="box-body">
                <!-- Date range -->
                <div id="{{id}}" class="tab-div echart">
                </div>
            </div><!-- /.box-body -->
        </div>
            </div>
    </script>
        <script id="page-chart-code" type="text/html">
    <div class="portlet box blue-madison">
            <div class="portlet-title">
                <div class="caption">
                    <i></i>{{chartitle}}<span datatype="Quota"></span>
                </div>

            </div>
            <div class="portlet-body">
                <!--<a class="btn btn-default" data-toggle="export" href="#" id="btnDown">下载数据</a>-->
                <div id="{{id}}" class="tab-div echart">
                </div>
            </div>
        </div>
            </script>
    <!-- spline -->
    <!-- table-->
    <script id="page-table" type="text/html">
        <div class="portlet box blue-madison">
        <div class="box box-primary">
            <div class="box-header with-border">
                <h3 class="box-title">{{tbtitle}}</h3>
            </div>
            <div class="box-body">
                <!-- Date range -->
                <div id="{{id}}" class="tab-div">
                </div>
            </div><!-- /.box-body -->
        </div>
            </div>
    </script>
      <script id="page-table-code" type="text/html">
            <div class="portlet box blue-madison">
            <div class="portlet-title">
                <div class="caption">
                    <i></i>{{tbtitle}}<span datatype="Quota"></span>
                </div>

            </div>
            <div class="portlet-body">
                <!--<a class="btn btn-default" data-toggle="export" href="#" id="btnDown">下载数据</a>-->
                <div id="{{id}}" class="tab-div echart">
                </div>
            </div>
        </div>
    </script>
    <!-- table -->

    <!--页面控件模版 结束 -->
    <script type="text/javascript">
        //数据参数控制、更新
        var datactrl = sdlbase.Class.extend({
            init: function () {
            },
            cache: {},
            //set
            setCache: function (keytp, opt) {
                var that = this;
                if (sdlbase.isUndef(that.cache[keytp.toString()])) {
                    var key = opt.key;
                    var val = opt.val;
                    that.cache[keytp.toString()] = {};
                    that.cache[keytp.toString()][key.toString()] = val;
                } else {
                    that.cache[keytp.toString()][opt.key.toString()] = opt.val;
                }
            },
            updateview: function () {
                var that = this;
                //设计视图生成
                var htmlcompile = new compile({ data: that.cache, mode: "html" });
                var html = htmlcompile.generateHtml();
                $("#sdl-design").html(html);
                //代码区域生成
                var codecompile = new compile({ data: that.cache, mode: "code" });
                var code = codecompile.generateHtml();
                $("#sdl-code-pre").html(sdlbase.html_encode(code));
            }
        });
        //生成页面代码
        var compile = sdlbase.Class.extend({
            init: function (opt) {
                var that = this;
                that.data = opt.data;
                that.mode = opt.mode;
            },
            //获取页面标题
            gettitle: function () {
                var that = this;
                if (!sdlbase.isUndef(that.data)) {
                    var source = that.data;
                    for (var i in source) {
                        var obj = source[i];
                        if (i.indexOf("page") != -1) {
                            for (var j in obj) {
                                if (j.indexOf("title") != -1) {
                                   // console.log(obj[j]);
                                    return obj[j];
                                }
                            }
                        }
                    }
                }
            },
            //生成查询控件代码
            generateControl: function () {
                var that = this;
                vrhtml = "";
                if (!sdlbase.isUndef(that.data)) {
                    var source = that.data;
                    for (var i in source) {
                        var obj = source[i];
                        if (i.indexOf("calender") != -1) {
                            vrhtml += that.generateCalendar(obj);
                        }
                        if (i.indexOf("select") != -1) {
                            vrhtml += that.generateSelect(obj);
                        }
                        if (i.indexOf("tab") != -1) {
                            vrhtml += that.generateTab(obj);
                        }
                    }
                }
                return vrhtml;
            },
            //生成选项卡
            generateTab: function (opt) {
                var that = this;
                if (sdlbase.isUndef(opt))
                    return;
                var modeopt = {};
                for (var i in opt) {
                    if (i.indexOf("id") != -1) {
                        modeopt["id"] = opt[i];
                    }
                    if (i.indexOf("source") != -1) {
                        modeopt["source"] = JSON.parse(opt[i]);
                    }
                    if (i.indexOf("text") != -1) {
                        modeopt["text"] = opt[i];
                    }
                }
                if (that.mode == "html") {
                    return template('page-tab', modeopt);
                } else {
                    return template('page-tab-code', modeopt);
                }
            },
            //生成下拉框
            generateSelect: function (opt) {
                var that = this;
                if (sdlbase.isUndef(opt))
                    return;
                var modeopt = {};
                for (var i in opt) {
                    if (i.indexOf("id") != -1) {
                        modeopt["id"] = opt[i];
                    }
                    if (i.indexOf("text") != -1) {
                        modeopt["text"] = opt[i];
                    }
                    if (i.indexOf("defval") != -1) {
                        modeopt["defval"] = opt[i];
                    }
                    if (i.indexOf("datafor") != -1) {
                        modeopt["datafor"] = opt[i];
                    }
                    if (i.indexOf("dataref") != -1) {
                        modeopt["dataref"] = opt[i];
                    }
                    if (i.indexOf("querytype") != -1) {
                        modeopt["querytype"] = opt[i];
                    }
                    if (i.indexOf("source") != -1) {
                        modeopt["source"] = opt[i];
                    }
                    if (i.indexOf("localsoucrce") != -1) {
                        modeopt["localsoucrce"] = JSON.parse(opt[i]);
                    }
                    if (i.indexOf("selecttype") != -1) {
                        modeopt["selecttype"] = opt[i];
                    }
                }
                if (that.mode == "html") {
                    return template('page-select', modeopt);
                } else {
                    return template('page-select-code', modeopt);
                }
            },
            //生成日历
            generateCalendar: function (opt) {
                var that = this;
                if (sdlbase.isUndef(opt))
                    return;
                var modeopt = {};
                for (var i in opt) {
                    if (i.indexOf("selectmode") != -1) {
                        modeopt["selectmode"] = opt[i];
                    }
                }
                if (that.mode == "html") {
                    return template('page-calendar', modeopt);
                } else {
                    return template('page-calendar-code', modeopt);
                }
            },
            //生成展示控件内容
            generateShow: function (opt) {
                var that = this;
                vrhtml = "";
                if (!sdlbase.isUndef(that.data)) {
                    var source = that.data;
                    for (var i in source) {
                        var obj = source[i];
                        if (i.indexOf("sampletb") != -1) {
                            vrhtml += that.generateTable(obj);
                        }
                        if (i.indexOf("spline") != -1) {
                            vrhtml += that.generateSpline(obj);
                        }
                        if (i.indexOf("bar") != -1) {
                            vrhtml += that.generateBar(obj);
                        }
                        if (i.indexOf("stacked") != -1) {
                            vrhtml += that.generateStacked(obj);
                        }
                        if (i.indexOf("funnel") != -1) {
                            vrhtml += that.generateFunnel(obj);
                        }
                    }
                }
                return vrhtml;
            },
            //生成表格
            generateTable: function (opt) {
                var that = this;
                if (sdlbase.isUndef(opt))
                    return;
                var modeopt = {};
                for (var i in opt) {
                    if (i.indexOf("id") != -1) {
                        modeopt["id"] = opt[i];
                    }
                    if (i.indexOf("tbtitle") != -1) {
                        modeopt["tbtitle"] = opt[i];
                    }
                }
                if (that.mode == "html") {
                    return template('page-table', modeopt);
                } else {
                    return template('page-table-code', modeopt);
                }
            },
            //生成折线图
            generateSpline: function (opt) {
                var that = this;
                if (sdlbase.isUndef(opt))
                    return;
                var modeopt = {};
                for (var i in opt) {
                    if (i.indexOf("id") != -1) {
                        modeopt["id"] = opt[i];
                    }
                    if (i.indexOf("chartitle") != -1) {
                        modeopt["chartitle"] = opt[i];
                    }
                }
                if (that.mode == "html") {
                    return template('page-chart', modeopt);
                } else {
                    return template('page-chart-code', modeopt);
                }
            },
            //生成柱状图
            generateBar: function (opt) {
                var that = this;
                if (sdlbase.isUndef(opt))
                    return;
                var modeopt = {};
                for (var i in opt) {
                    if (i.indexOf("id") != -1) {
                        modeopt["id"] = opt[i];
                    }
                    if (i.indexOf("chartitle") != -1) {
                        modeopt["chartitle"] = opt[i];
                    }
                }
                if (that.mode == "html") {
                    return template('page-chart', modeopt);
                } else {
                    return template('page-chart-code', modeopt);
                }
            },
            //生成堆积柱状图
            generateStacked: function (opt) {
                var that = this;
                if (sdlbase.isUndef(opt))
                    return;
                var modeopt = {};
                for (var i in opt) {
                    if (i.indexOf("id") != -1) {
                        modeopt["id"] = opt[i];
                    }
                    if (i.indexOf("chartitle") != -1) {
                        modeopt["chartitle"] = opt[i];
                    }
                }
                if (that.mode == "html") {
                    return template('page-chart', modeopt);
                } else {
                    return template('page-chart-code', modeopt);
                }
            },
            //生成漏斗图
            generateFunnel: function (opt) {
                var that = this;
                if (sdlbase.isUndef(opt))
                    return;
                var modeopt = {};
                for (var i in opt) {
                    if (i.indexOf("id") != -1) {
                        modeopt["id"] = opt[i];
                    }
                    if (i.indexOf("chartitle") != -1) {
                        modeopt["chartitle"] = opt[i];
                    }
                }
                if (that.mode == "html") {
                    return template('page-chart', modeopt);
                } else {
                    return template('page-chart-code', modeopt);
                }
            },
            //控件代码与页面布局合并
            generateHtml: function () {
                var that = this;
                var opt = {};
                opt["title"] = that.gettitle();
                opt["search"] = that.generateControl();
                opt["show"] = that.generateShow();
                opt["script"] = that.generateScript();

                if (that.mode == "html") {
                    return template('page', opt);
                } else {
                    return template('page-code', opt);
                }
            },
            //生成脚本
            generateScript: function () {
                //请求脚本
                var that = this;
                var scriptgen = '<scr' + 'ipt id="sdljshander" type="text/javascript" src="assets/local/script/sdljshander.js"';
                scriptgen += "data='" + JSON.stringify(that.data) + "'></scr" + "ipt>";
 		scriptgen += "<script> if(typeof AutoHome != 'undefined'){AutoHome.PageBar();}</scr" + "ipt>";
                return scriptgen;
            }
        });
        //属性面板控制
        var ctlpannel = datactrl.extend({
            //ctro
            init: function (opt) {
                if (sdlbase.isUndef(opt))
                    return;
                this.ctropt = opt;
            },
            //get inp
            getinputhl: function (opt) {
                if (sdlbase.isUndef(opt))
                    return;
                return template('input', opt);
            },
            getselecthl: function (opt) {
                if (sdlbase.isUndef(opt))
                    return;
                return template('select', opt);
            },
            getcheckhl: function (opt) {
                if (sdlbase.isUndef(opt))
                    return;
                return template('checkbox', opt);
            },
            getareahl: function (opt) {
                if (sdlbase.isUndef(opt))
                    return;
                return template('textarea', opt);
            },
            bindchage: function (id) {
                var that = this;
                $("#ctlpannel").on("change", "#" + id, function () {
                    var $this = $(this);
                    that.saveProp(this.id, $this.val());
                    //更新页面
                    that.updateview();
                    ////绑定change
                   // console.log(that.cache);
                });
            },
            render: function () {
                var that = this;
                var opt = that.ctropt;
                $("#ctlpannel").data("key", opt.key);
                var rhtml = "";
                var prop = opt.prop;
                for (var i = 0; i < prop.length; i++) {
                    var md = prop[i].type;
                    switch (prop[i].type) {
                        case "input":
                            {
                                rhtml += that.getinputhl(prop[i]);
                                that.saveProp(prop[i].id, prop[i].val);
                                that.bindchage(prop[i].id);
                                break;
                            }
                        case "select":
                            {
                                rhtml += that.getselecthl(prop[i]);
                                that.saveProp(prop[i].id, prop[i].val);
                                that.bindchage(prop[i].id);
                                break;
                            }
                        case "checkbox":
                            {
                                rhtml += that.getcheckhl(prop[i]);
                                that.saveProp(prop[i].id, prop[i].val);
                                break;
                            }
                        case "textarea":
                            {
                                rhtml += that.getareahl(prop[i]);
                                that.saveProp(prop[i].id, prop[i].val);
                                that.bindchage(prop[i].id);
                                break;
                            }
                    }
                }
                $("#ctlpannel").html(rhtml);
                //更新页面
                that.updateview();
                ////绑定change
                // console.log(that.cache);
            },
            //获取当前面板key
            getKey: function () {
                return $("#ctlpannel").data("key");
            },
            //保存面板属性
            saveProp: function (key, val) {
                var that = this;
                that.setCache(that.getKey(), { key: key, val: val });
            }
        });
        //控件默认参数
        var datadef = {
            calender: function () {
                return {
                    key: sdlbase.getPK("calender"),
                    prop: [
                            {
                                type: "select", id: sdlbase.getPK("selectmode"), text: "日历选择模式", val: "day",
                                option: [
                                  { key: "day", text: "日模式" },
                                  { key: "month", text: "月模式" },
                                  { key: "quarter", text: "季模式" },
                                  { key: "halfyear", text: "半年模式" },
                                  { key: "year", text: "年模式" }
                                ]
                            }]
                }
            },
            select: function () {
                return {
                    key: sdlbase.getPK("select"),
                    prop: [
                            { type: "input", id: sdlbase.getPK("id"), text: "控件ID", val: sdlbase.getPK("input") },
                            { type: "input", id: sdlbase.getPK("text"), text: "控件描述", val: "控件描述" },
                            { type: "input", id: sdlbase.getPK("defval"), text: "控件默认值", val: "" },
                            { type: "input", id: sdlbase.getPK("datafor"), text: "联动控件ID", val: "" },
                            { type: "input", id: sdlbase.getPK("dataref"), text: "初始化控件ID", val: "" },
                            {
                                type: "select", id: sdlbase.getPK("querytype"), text: "数据库参数类型", val: "1",
                                option: [
                                    { key: "1", text: "整型" },
                                    { key: "2", text: "字符串" },
                                    { key: "3", text: "季模式" }
                                ]
                            },
                            {
                                type: "select", id: sdlbase.getPK("selecttype"), text: "多选或单选", val: "single",
                                option: [
                                    { key: "single", text: "单选" },
                                    { key: "multiple", text: "多选" },
                                ]
                            },
                            {
                                type: "select", id: sdlbase.getPK("source"), text: "数据源", val: "local",
                                option: [
				  { key: "local", text: "本地" },
				  { key: "wzcity", text: "城市(违章查询)" },
{ key: "appchannel", text: "APP渠道" },
   				  { key: "appversion", text: "APP版本" },
 				  { key: "user", text: "用户" },
   				  { key: "team", text: "部门" },
                                  { key: "queue", text: "队列" },
				  { key: "hdfs", text: "hdfs路径" },
                                  { key: "1", text: "厂商" },
                                  { key: "2", text: "城市" },

                                ]
                            },
                            {
                                type: "textarea", id: sdlbase.getPK("localsoucrce"),
                                text: "本地数据源", val: "key:'key',value:'val1'",
                                val: '[{"key":"1","text":"示例数据1"},{"key":"2","text":"示例数据2"}]',
                                desc: '[{"key":"1","text":"示例数据1"},{"key":"2","text":"示例数据2"}]'
                            }
                    ]
                }
            },
            tab: function () {
                return {
                    key: sdlbase.getPK("tab"),
                    prop: [
                            { type: "input", id: sdlbase.getPK("id"), text: "控件ID", val: sdlbase.getPK("input") },
                            { type: "input", id: sdlbase.getPK("text"), text: "控件描述", val: "控件描述" },
                            {
                                type: "textarea", id: sdlbase.getPK("source"),
                                text: "数据源",
                                val: '[{"key":"1","text":"选项1"},{"key":"2","text":"选项1"}]',
                                desc: '[{"key":"1","text":"选项1"},{"key":"2","text":"选项2"}]'
                            }
                    ]
                }
            },
            //控件默认参数spline
            spline: function () {
                return {
                    key: sdlbase.getPK("spline"),
                    prop: [
                            { type: "input", id: sdlbase.getPK("id"), text: "容器ID", val: sdlbase.getPK("input") },
                            { type: "input", id: sdlbase.getPK("chartitle"), text: "折线图标题", val: "折线图标题" },
                            { type: "input", id: sdlbase.getPK("proc"), text: "存储过程", val: "Dealer_Clue_Get400" },
                            {
                                type: "input", id: sdlbase.getPK("namecol"),
                                text: 'x轴数据配置',
                                val: 'dim_day_id'
                            },
                            {
                                type: "textarea", id: sdlbase.getPK("groupcol"),
                                text: "y轴数据配置",
                                val: '[{ "title": "PV", "val": "call_ord_num","datatp":"date" },{ "title": "UV", "val": "call_ord_rd_num", "datatp": "decimal" },{ "title" : "人均停留时长", "val": "call_ord_ind_num", "datatp": { "key": "percent", "reserve": "3", "yUnit": "%" } }]',
                                desc: '[{ "title": "PV", "val": "call_ord_num","datatp":"date" },{ "title": "UV", "val": "call_ord_rd_num", "datatp": "decimal" },{ "title" : "人均停留时长", "val": "call_ord_ind_num", "datatp": { "key": "percent", "reserve": "3", "yUnit": "%" } }]'
                            }
                    ]
                }
            },
            bar: function () {
                return {
                    key: sdlbase.getPK("bar"),
                    prop: [
                            { type: "input", id: sdlbase.getPK("id"), text: "容器ID", val: sdlbase.getPK("input") },
                            { type: "input", id: sdlbase.getPK("chartitle"), text: "柱状图标题", val: "柱状图标题" },
                            { type: "input", id: sdlbase.getPK("proc"), text: "存储过程", val: "Dealer_Clue_Get400" },
                            {
                                type: "input", id: sdlbase.getPK("namecol"),
                                text: 'x轴数据配置',
                                val: 'dim_day_id'
                            },
                            {
                                type: "textarea", id: sdlbase.getPK("groupcol"),
                                text: "y轴数据配置",
                                val: '[{ "title": "PV", "val": "call_ord_num","datatp":"date" },{ "title": "UV", "val": "call_ord_rd_num", "datatp": "decimal" },{ "title" : "人均停留时长", "val": "call_ord_ind_num", "datatp": { "key": "percent", "reserve": "3", "yUnit": "%" } }]',
                                desc: '[{ "title": "PV", "val": "call_ord_num","datatp":"date" },{ "title": "UV", "val": "call_ord_rd_num", "datatp": "decimal" },{ "title" : "人均停留时长", "val": "call_ord_ind_num", "datatp": { "key": "percent", "reserve": "3", "yUnit": "%" } }]'
                            }
                    ]
                }
            },
            stacked: function () {
                return {
                    key: sdlbase.getPK("stacked"),
                    prop: [
                            { type: "input", id: sdlbase.getPK("id"), text: "容器ID", val: sdlbase.getPK("input") },
                            { type: "input", id: sdlbase.getPK("chartitle"), text: "堆积柱状图标题", val: "堆积柱状图标题" },
                            { type: "input", id: sdlbase.getPK("proc"), text: "存储过程", val: "Dealer_Clue_Get400" },
                            {
                                type: "input",
                                id: sdlbase.getPK("namecol"),
                                text: 'x轴数据配置',
                                val: 'dim_day_id'
                            },
                            {
                                type: "textarea", id: sdlbase.getPK("groupcol"),
                                text: "y轴数据配置",
                                val: '[{ "title": "PV", "val": "call_ord_num","datatp":{"stack" : "搜索引擎"}},{ "title": "UV", "val": "call_ord_rd_num", "datatp": { "key": "percent", "reserve": "3", "yUnit": "%","markLine":true} },{ "title" : "人均停留时长", "val": "call_ord_ind_num", "datatp":{"stack":"搜索引擎"}}]',
                                desc: '[{ "title": "PV", "val": "call_ord_num","datatp":{"stack": "搜索引擎"} },{ "title": "UV", "val": "call_ord_rd_num", "datatp": { "key": "percent", "reserve": "3", "yUnit": "%", "markLine": true } },{ "title" : "人均停留时长", "val": "call_ord_ind_num", "datatp":{"stack":"搜索引擎"}}]'
                            }
                    ]
                }
            },
            funnel: function () {
                return {
                    key: sdlbase.getPK("funnel"),
                    prop: [
                            { type: "input", id: sdlbase.getPK("id"), text: "容器ID", val: sdlbase.getPK("input") },
                            { type: "input", id: sdlbase.getPK("chartitle"), text: "漏斗图标题", val: "漏斗图标题" },
                            { type: "input", id: sdlbase.getPK("proc"), text: "存储过程", val: "Dealer_Clue_Get400" },
                            {
                                type: "textarea", id: sdlbase.getPK("groupcol"),
                                text: "y轴数据配置",
                                val: '[{ "title": "PV", "val": "call_ord_num"},{ "title": "UV", "val": "call_ord_rd_num"},{ "title" : "人均停留时长", "val": "call_ord_ind_num"}]',
                                desc: '[{ "title": "PV", "val": "call_ord_num"},{ "title": "UV", "val": "call_ord_rd_num"},{ "title" : "人均停留时长", "val": "call_ord_ind_num"}]'
                            }
                    ]
                }
            },
            input: "",
            sampletb: function () {
                return {
                    key: sdlbase.getPK("sampletb"),
                    prop: [
                            { type: "input", id: sdlbase.getPK("id"), text: "容器ID", val: sdlbase.getPK("table") },
                            { type: "input", id: sdlbase.getPK("tbtitle"), text: "表格标题", val: "表格标题" },
                            //{
                            //    type: "select", id: sdlbase.getPK("pagingtp"), text: "分页方式", val: "client",
                            //    option: [
                            //        { key: "client", text: "客户端" },
                            //        { key: "server", text: "服务端" }
                            //    ]
                            //},
                            { type: "input", id: sdlbase.getPK("proc"), text: "存储过程", val: "getData" },
                            {
                                type: "textarea", id: sdlbase.getPK("thheader"),
                                text: "复杂表头配置",
                                val: '',
                                desc: ''
                            },
                            {
                                type: "textarea", id: sdlbase.getPK("source"),
                                text: "数据列配置",
                                val: ' [{"title": "日期", "data":"dim_day","datatp": "date"},{ "title": "注册用户下单数","data":"s_num"},{"title": "无效号码下单数" , "data":"b_num"}, { "title": "无效号码下单数占比" , "data":"s_num","datatp":"percent"},{"title": "非注册下单", "data":"dim_day"},{"title": "未移动下单", "data":"dim_day"}]',
                                desc: '[{"title": "日期", "data":"dim_day","datatp": "date" },{ "title": "注册用户下单数","data":"s_num"},{"title": "无效号码下单数" , "data":"b_num"}, { "title": "无效号码下单数占比" , "data":"s_num","datatp":"percent"}]'
                            }]
                }
            },
            servertb: "",
        };
        //页面控制
        var pagectrl = sdlbase.Class.extend({
            init: function (opt) {
                var that = this;
                that.initctrl();
            },
            //初始化控件
            initctrl: function () {
                //验证身份
//                $.ajax({
//                    type: "GET",
//                    url: "../Data/OAuth.ashx",
//                    timeout: 100000,
//                    cache: false,
//                    beforeSend: function (xhr) {
//
//                    },
//                    error: function (request, status, error) {
//                        // console.log(error);
//                        //  window.location = "page404.html";
//                        alert("请登录后,在使用在线报表功能功能");
//                        window.location = "page404.html";
//                    },
//                    async: false,
//                    complete: function (XHR, TS) {
//
//                    },
//                    success: function (data, status) {
//                        var rst = JSON.parse(data);
//                        if (rst.status && rst.status == -1) {
//                            alert("请登录后,在使用在线报表功能功能");
//                            window.location = "page404.html";
//                        } else {
//                            $("body").data("userid", rst.result.userid);
//                        }
//
//                    }
//                });
                var that = this;
                var layer;
                $("[data-ctro]").each(function (index, element) {
                    var $that = $(element);
                    $that.parent('a').on("click", function () {
                        //if ($that.attr("data-prop") == "singel")
                        //    return;
                        //控件面板
                        var pannel_ins = new ctlpannel(datadef[$that.attr("data-ctro").toString()]());
                        pannel_ins.render();

                    })
                })
                $("#updata").on('click', function () {
                    var pagenamehtml = template("input", { id: "userpagename", text: "页面名称", val: "" });
                    var filenamehtml = template("input", { id: "userfilename", text: "文件名称", val: "" });
                    var procnamehtml = template("input", { id: "procname", text: "初始化存储过程", val: "" });
                    var datasource = template("select",
                        {
                            text: "数据库", id: "Dbstr", val: "DP_Dealer",
                            option: [
				{ key: "DP_Wz", text: "BreakRulesStatistics" },
                                { key: "DP_Dealer", text: "经销商" },
                                { key: "DP_Trans", text: "流量转换" },
                                { key: "data_platform", text: "数据门户" },
				{ key: "DP_Mysql", text: "集群MySql" },
				{ key: "DP_AppStat", text: "AppStat" }
                            ]
                        })
                    var button = '<div class="form-group"><div class="col-xs-12"><button class="btn btn-block btn-info" id="sureupdata">确认提交</button> </div></div>'
                    if (!layer) {
                        layer = new sdltool.simple_popLayer({
                            title: "页面基本信息",
                            content: pagenamehtml + filenamehtml + procnamehtml + datasource + button,
                            hasMask: true
                        });
                    }
                    layer.open();
                })

                $("body").on('click', '#sureupdata', function () {
                    //更新数据库设置
                    var val = $("#Dbstr").val();
                    var procval = $("#procname").val();
                    var pagename = $("#userpagename").val();
                    var filename = $("#userfilename").val();
                    var ctrlinstatce = new datactrl();
                    ctrlinstatce.setCache("db", { key: "Dbstr", val: val });
                    ctrlinstatce.setCache("db", { key: "Name", val: procval });
		    ctrlinstatce.setCache("db", { key: "DbType", val: "MySql"});
                    ctrlinstatce.setCache("page", { key: "title", val: pagename });
                    ctrlinstatce.updateview();

                    var html = $("#sdl-code-pre").html();
                    //html.replace("col-md-2", "col-md-1");
                    $.ajax({
                        type: "POST",
                        url: "Data/HtmlHandler.ashx",
                        timeout: 100000,
                        data:
                        {
                            html: sdlbase.html_decode(html),
                            filename: filename,
                            pagename: pagename,
                            userid: $("body").data("userid")
                        },
                        cache: false,
                        dataType: "json",
                        beforeSend: function (xhr) {

                        },
                        error: function (request, status, error) {

                        },
                        async: false,
                        complete: function (XHR, TS) {
                            alert("上传成功,请等待管理员审核...");
                        },
                        success: function (data, status) {

                        }
                    });
                    layer.close();
                })
            }
        });
        new pagectrl();
    </script>
</body>
</html>
